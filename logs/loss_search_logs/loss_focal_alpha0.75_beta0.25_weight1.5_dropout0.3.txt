=== 命令 ===
python main.py --loss_type focal --alpha 0.75 --beta 0.25 --neural_init_weight 1.5 --dropout 0.3 --name loss_focal_alpha0.75_beta0.25_weight1.5_dropout0.3 --wandb True

=== 标准输出 ===
Config Info:
device: cuda
batch_size: 32
learning_rate: 0.0001
num_epochs: 10
val_ratio: 0.2
wandb: True
early_stop_patience: 3
text_model_name: ./pretrained_models/bert-base-uncased
image_model_name: ./pretrained_models/swinv2-base
data_dir: data
train_file: train.txt
test_file: test_without_label.txt
result_file: result.txt
use_kfold: False
k_folds: 5
project_name: multimodal_sentiment_analysis_loss
use_text: True
use_image: True
feature_fusion: concat
num_classes: 3
log_iteration: 10
name: loss_focal_alpha0.75_beta0.25_weight1.5_dropout0.3
text_dim: 128
image_dim: 256
dropout: 0.3
loss_type: focal
alpha: 0.75
beta: 0.25
neural_init_weight: 1.5

数据集统计信息:
总样本数: 6869
原始样本数: 4000
增强样本数: 2869

标签分布:
negative: 2386 (34.74%)
neutral: 2095 (30.50%)
positive: 2388 (34.76%)

缺失文本数: 0
缺失图像数: 0
Training on cuda

=== 第 1 次迭代调试信息 ===
当前类别统计：
positive: count=12.0, difficulty=0.6843, log_difficulty=0.5214, weight=3.6069
neutral: count=7.0, difficulty=0.6731, log_difficulty=0.5147, weight=3.5733
negative: count=13.0, difficulty=0.6406, log_difficulty=0.4950, weight=3.4752

当前batch的pt分布：
positive: min=0.1779, max=0.4192, mean=0.3157
neutral: min=0.2084, max=0.4205, mean=0.3269
negative: min=0.2011, max=0.7164, mean=0.3594

当前batch准确率：
整体准确率: 0.2188
positive 准确率: 0.1667
neutral 准确率: 0.2857
negative 准确率: 0.2308

损失分量：
基础交叉熵: 1.1309
焦点损失: 0.3805
边界损失: 0.8401
总损失: 1.2234
Epoch 1 [1/172] - loss: 1.2234, acc: 0.2188
Epoch 1 [2/172] - loss: 1.2074
Epoch 1 [3/172] - loss: 1.3166
Epoch 1 [4/172] - loss: 1.1480
Epoch 1 [5/172] - loss: 1.2378
Epoch 1 [6/172] - loss: 1.4461
Epoch 1 [7/172] - loss: 1.3074
Epoch 1 [8/172] - loss: 1.4008
Epoch 1 [9/172] - loss: 1.3122
Epoch 1 [10/172] - loss: 1.4091, acc: 0.4688
Epoch 1 [11/172] - loss: 1.2049
Epoch 1 [12/172] - loss: 1.0837
Epoch 1 [13/172] - loss: 1.3492
Epoch 1 [14/172] - loss: 1.5973
Epoch 1 [15/172] - loss: 1.2374
Epoch 1 [16/172] - loss: 1.0890
Epoch 1 [17/172] - loss: 1.4844
Epoch 1 [18/172] - loss: 1.3937
Epoch 1 [19/172] - loss: 1.0052
Epoch 1 [20/172] - loss: 1.3803, acc: 0.3438
Epoch 1 [21/172] - loss: 0.9859
Epoch 1 [22/172] - loss: 1.0537
Epoch 1 [23/172] - loss: 1.4984
Epoch 1 [24/172] - loss: 1.1004
Epoch 1 [25/172] - loss: 1.1816
Epoch 1 [26/172] - loss: 1.1370
Epoch 1 [27/172] - loss: 1.2468
Epoch 1 [28/172] - loss: 0.8643
Epoch 1 [29/172] - loss: 1.0549
Epoch 1 [30/172] - loss: 1.0326, acc: 0.3438
Epoch 1 [31/172] - loss: 1.0430
Epoch 1 [32/172] - loss: 0.9768
Epoch 1 [33/172] - loss: 0.9062
Epoch 1 [34/172] - loss: 1.1329
Epoch 1 [35/172] - loss: 0.7580
Epoch 1 [36/172] - loss: 0.9023
Epoch 1 [37/172] - loss: 1.2924
Epoch 1 [38/172] - loss: 0.7342
Epoch 1 [39/172] - loss: 1.0150
Epoch 1 [40/172] - loss: 1.0395, acc: 0.4062
Epoch 1 [41/172] - loss: 1.3149
Epoch 1 [42/172] - loss: 0.8672
Epoch 1 [43/172] - loss: 1.1577
Epoch 1 [44/172] - loss: 1.1843
Epoch 1 [45/172] - loss: 1.0386
Epoch 1 [46/172] - loss: 0.8755
Epoch 1 [47/172] - loss: 0.9972
Epoch 1 [48/172] - loss: 1.0198
Epoch 1 [49/172] - loss: 0.8043
Epoch 1 [50/172] - loss: 0.7623, acc: 0.5625
Epoch 1 [51/172] - loss: 0.9605
Epoch 1 [52/172] - loss: 0.8869
Epoch 1 [53/172] - loss: 1.1112
Epoch 1 [54/172] - loss: 1.0280
Epoch 1 [55/172] - loss: 0.7140
Epoch 1 [56/172] - loss: 0.9620
Epoch 1 [57/172] - loss: 1.2246
Epoch 1 [58/172] - loss: 0.8838
Epoch 1 [59/172] - loss: 0.9547
Epoch 1 [60/172] - loss: 0.7779, acc: 0.6875
Epoch 1 [61/172] - loss: 0.9548
Epoch 1 [62/172] - loss: 0.7879
Epoch 1 [63/172] - loss: 0.8165
Epoch 1 [64/172] - loss: 0.9086
Epoch 1 [65/172] - loss: 1.0225
Epoch 1 [66/172] - loss: 1.1504
Epoch 1 [67/172] - loss: 1.0250
Epoch 1 [68/172] - loss: 1.2014
Epoch 1 [69/172] - loss: 1.0547
Epoch 1 [70/172] - loss: 1.0433, acc: 0.5625
Epoch 1 [71/172] - loss: 0.9206
Epoch 1 [72/172] - loss: 0.8641
Epoch 1 [73/172] - loss: 0.6650
Epoch 1 [74/172] - loss: 1.1477
Epoch 1 [75/172] - loss: 0.5747
Epoch 1 [76/172] - loss: 0.7470
Epoch 1 [77/172] - loss: 0.8660
Epoch 1 [78/172] - loss: 0.7389
Epoch 1 [79/172] - loss: 0.7555
Epoch 1 [80/172] - loss: 0.7342, acc: 0.7812
Epoch 1 [81/172] - loss: 0.8102
Epoch 1 [82/172] - loss: 0.9080
Epoch 1 [83/172] - loss: 0.7060
Epoch 1 [84/172] - loss: 0.7096
Epoch 1 [85/172] - loss: 0.9463
Epoch 1 [86/172] - loss: 0.8899
Epoch 1 [87/172] - loss: 0.5967
Epoch 1 [88/172] - loss: 1.0124
Epoch 1 [89/172] - loss: 1.1259
Epoch 1 [90/172] - loss: 0.8790, acc: 0.5625
Epoch 1 [91/172] - loss: 0.5174
Epoch 1 [92/172] - loss: 0.6229
Epoch 1 [93/172] - loss: 0.7852
Epoch 1 [94/172] - loss: 0.5656
Epoch 1 [95/172] - loss: 0.8638
Epoch 1 [96/172] - loss: 0.9235
Epoch 1 [97/172] - loss: 0.7956
Epoch 1 [98/172] - loss: 0.9190
Epoch 1 [99/172] - loss: 0.7565
Epoch 1 [100/172] - loss: 1.0547, acc: 0.6250

=== 第 101 次迭代调试信息 ===
当前类别统计：
positive: count=1130.0, difficulty=0.5823, log_difficulty=0.4589, weight=3.2943
neutral: count=983.0, difficulty=0.5850, log_difficulty=0.4606, weight=3.3029
negative: count=1119.0, difficulty=0.5964, log_difficulty=0.4678, weight=3.3388

当前batch的pt分布：
positive: min=0.1634, max=0.6030, mean=0.4009
neutral: min=0.4159, max=0.9232, mean=0.6026
negative: min=0.2284, max=0.6024, mean=0.3853

当前batch准确率：
整体准确率: 0.5625
positive 准确率: 0.5000
neutral 准确率: 1.0000
negative 准确率: 0.5000

损失分量：
基础交叉熵: 0.9348
焦点损失: 0.2793
边界损失: 0.6549
总损失: 0.8590
Epoch 1 [101/172] - loss: 0.8590
Epoch 1 [102/172] - loss: 1.0112
Epoch 1 [103/172] - loss: 0.8651
Epoch 1 [104/172] - loss: 0.7792
Epoch 1 [105/172] - loss: 0.8904
Epoch 1 [106/172] - loss: 0.8686
Epoch 1 [107/172] - loss: 0.6037
Epoch 1 [108/172] - loss: 0.8987
Epoch 1 [109/172] - loss: 0.4953
Epoch 1 [110/172] - loss: 0.5710, acc: 0.7812
Epoch 1 [111/172] - loss: 0.8237
Epoch 1 [112/172] - loss: 0.4284
Epoch 1 [113/172] - loss: 0.5358
Epoch 1 [114/172] - loss: 0.6136
Epoch 1 [115/172] - loss: 0.4958
Epoch 1 [116/172] - loss: 0.7614
Epoch 1 [117/172] - loss: 0.6017
Epoch 1 [118/172] - loss: 0.5225
Epoch 1 [119/172] - loss: 0.6691
Epoch 1 [120/172] - loss: 0.6463, acc: 0.7188
Epoch 1 [121/172] - loss: 0.5266
Epoch 1 [122/172] - loss: 1.1078
Epoch 1 [123/172] - loss: 0.5594
Epoch 1 [124/172] - loss: 0.6823
Epoch 1 [125/172] - loss: 0.4376
Epoch 1 [126/172] - loss: 0.9556
Epoch 1 [127/172] - loss: 0.4630
Epoch 1 [128/172] - loss: 0.4400
Epoch 1 [129/172] - loss: 0.6725
Epoch 1 [130/172] - loss: 0.4900, acc: 0.7812
Epoch 1 [131/172] - loss: 0.4164
Epoch 1 [132/172] - loss: 0.6878
Epoch 1 [133/172] - loss: 0.6728
Epoch 1 [134/172] - loss: 0.6350
Epoch 1 [135/172] - loss: 0.6910
Epoch 1 [136/172] - loss: 0.6372
Epoch 1 [137/172] - loss: 0.5166
Epoch 1 [138/172] - loss: 0.5573
Epoch 1 [139/172] - loss: 0.4002
Epoch 1 [140/172] - loss: 0.5797, acc: 0.7812
Epoch 1 [141/172] - loss: 0.4594
Epoch 1 [142/172] - loss: 0.4524
Epoch 1 [143/172] - loss: 0.7639
Epoch 1 [144/172] - loss: 0.3319
Epoch 1 [145/172] - loss: 0.7025
Epoch 1 [146/172] - loss: 0.7893
Epoch 1 [147/172] - loss: 0.7535
Epoch 1 [148/172] - loss: 0.5415
Epoch 1 [149/172] - loss: 0.4512
Epoch 1 [150/172] - loss: 0.6546, acc: 0.8125
Epoch 1 [151/172] - loss: 0.5649
Epoch 1 [152/172] - loss: 0.3969
Epoch 1 [153/172] - loss: 0.4781
Epoch 1 [154/172] - loss: 0.4526
Epoch 1 [155/172] - loss: 0.5402
Epoch 1 [156/172] - loss: 1.4695
Epoch 1 [157/172] - loss: 0.5270
Epoch 1 [158/172] - loss: 0.5848
Epoch 1 [159/172] - loss: 0.8327
Epoch 1 [160/172] - loss: 0.4608, acc: 0.8125
Epoch 1 [161/172] - loss: 0.4181
Epoch 1 [162/172] - loss: 0.6169
Epoch 1 [163/172] - loss: 0.6429
Epoch 1 [164/172] - loss: 0.6762
Epoch 1 [165/172] - loss: 0.5782
Epoch 1 [166/172] - loss: 0.3840
Epoch 1 [167/172] - loss: 0.5209
Epoch 1 [168/172] - loss: 0.6059
Epoch 1 [169/172] - loss: 0.6192
Epoch 1 [170/172] - loss: 0.4444, acc: 0.7500
Epoch 1 [171/172] - loss: 0.9432
Epoch 1 [172/172] - loss: 0.5002

类别准确率:
positive: 0.6467 (302/467)
neutral: 0.6265 (52/83)
negative: 0.6200 (155/250)

Epoch 1/10
Train Loss: 0.5847, Train Acc: 0.7434
Val Loss: 0.7938, Val Acc: 0.6362
Epoch 2 [1/172] - loss: 0.6297, acc: 0.8125
Epoch 2 [2/172] - loss: 0.3798
Epoch 2 [3/172] - loss: 0.3279
Epoch 2 [4/172] - loss: 0.6123
Epoch 2 [5/172] - loss: 0.4355
Epoch 2 [6/172] - loss: 0.5087
Epoch 2 [7/172] - loss: 0.5594
Epoch 2 [8/172] - loss: 0.5248
Epoch 2 [9/172] - loss: 0.3619
Epoch 2 [10/172] - loss: 0.3996, acc: 0.8438
Epoch 2 [11/172] - loss: 0.3016
Epoch 2 [12/172] - loss: 0.3520
Epoch 2 [13/172] - loss: 0.6343
Epoch 2 [14/172] - loss: 0.4419
Epoch 2 [15/172] - loss: 0.3704
Epoch 2 [16/172] - loss: 0.4150
Epoch 2 [17/172] - loss: 0.4202
Epoch 2 [18/172] - loss: 0.4372
Epoch 2 [19/172] - loss: 0.2258
Epoch 2 [20/172] - loss: 0.2607, acc: 0.8750
Epoch 2 [21/172] - loss: 0.3028
Epoch 2 [22/172] - loss: 0.2646
Epoch 2 [23/172] - loss: 0.4267
Epoch 2 [24/172] - loss: 0.5165
Epoch 2 [25/172] - loss: 0.3787
Epoch 2 [26/172] - loss: 0.2076
Epoch 2 [27/172] - loss: 0.3347
Epoch 2 [28/172] - loss: 0.2400

=== 第 201 次迭代调试信息 ===
当前类别统计：
positive: count=2247.0, difficulty=0.5199, log_difficulty=0.4186, weight=3.0931
neutral: count=1952.0, difficulty=0.4848, log_difficulty=0.3953, weight=2.9763
negative: count=2216.0, difficulty=0.5275, log_difficulty=0.4236, weight=3.1182

当前batch的pt分布：
positive: min=0.4612, max=0.8514, mean=0.6052
neutral: min=0.4450, max=0.9362, mean=0.7247
negative: min=0.0690, max=0.8476, mean=0.5769

当前batch准确率：
整体准确率: 0.9062
positive 准确率: 1.0000
neutral 准确率: 1.0000
negative 准确率: 0.7500

损失分量：
基础交叉熵: 0.5367
焦点损失: 0.1423
边界损失: 0.3997
总损失: 0.4312
Epoch 2 [29/172] - loss: 0.4312
Epoch 2 [30/172] - loss: 0.2468, acc: 0.8438
Epoch 2 [31/172] - loss: 0.3002
Epoch 2 [32/172] - loss: 0.4040
Epoch 2 [33/172] - loss: 0.3519
Epoch 2 [34/172] - loss: 0.5587
Epoch 2 [35/172] - loss: 0.2114
Epoch 2 [36/172] - loss: 0.6439
Epoch 2 [37/172] - loss: 0.2428
Epoch 2 [38/172] - loss: 0.2677
Epoch 2 [39/172] - loss: 0.4615
Epoch 2 [40/172] - loss: 0.4577, acc: 0.7812
Epoch 2 [41/172] - loss: 0.3061
Epoch 2 [42/172] - loss: 0.2990
Epoch 2 [43/172] - loss: 0.4353
Epoch 2 [44/172] - loss: 0.5577
Epoch 2 [45/172] - loss: 0.2425
Epoch 2 [46/172] - loss: 0.2078
Epoch 2 [47/172] - loss: 0.3418
Epoch 2 [48/172] - loss: 0.5505
Epoch 2 [49/172] - loss: 0.3786
Epoch 2 [50/172] - loss: 0.4059, acc: 0.7812
Epoch 2 [51/172] - loss: 0.5848
Epoch 2 [52/172] - loss: 0.2222
Epoch 2 [53/172] - loss: 0.3140
Epoch 2 [54/172] - loss: 0.2383
Epoch 2 [55/172] - loss: 0.3501
Epoch 2 [56/172] - loss: 0.3482
Epoch 2 [57/172] - loss: 0.3741
Epoch 2 [58/172] - loss: 0.4461
Epoch 2 [59/172] - loss: 0.4840
Epoch 2 [60/172] - loss: 0.2886, acc: 0.8125
Epoch 2 [61/172] - loss: 0.1825
Epoch 2 [62/172] - loss: 0.3285
Epoch 2 [63/172] - loss: 0.3636
Epoch 2 [64/172] - loss: 0.6173
Epoch 2 [65/172] - loss: 0.3016
Epoch 2 [66/172] - loss: 0.2614
Epoch 2 [67/172] - loss: 0.1620
Epoch 2 [68/172] - loss: 0.3026
Epoch 2 [69/172] - loss: 0.2852
Epoch 2 [70/172] - loss: 0.4527, acc: 0.7812
Epoch 2 [71/172] - loss: 0.2439
Epoch 2 [72/172] - loss: 0.2895
Epoch 2 [73/172] - loss: 0.4128
Epoch 2 [74/172] - loss: 0.2560
Epoch 2 [75/172] - loss: 0.3213
Epoch 2 [76/172] - loss: 0.4323
Epoch 2 [77/172] - loss: 0.2813
Epoch 2 [78/172] - loss: 0.3159
Epoch 2 [79/172] - loss: 0.2168
Epoch 2 [80/172] - loss: 0.2218, acc: 0.9375
Epoch 2 [81/172] - loss: 0.2623
Epoch 2 [82/172] - loss: 0.2354
Epoch 2 [83/172] - loss: 0.3356
Epoch 2 [84/172] - loss: 0.3459
Epoch 2 [85/172] - loss: 0.1982
Epoch 2 [86/172] - loss: 0.3416
Epoch 2 [87/172] - loss: 0.6743
Epoch 2 [88/172] - loss: 0.3484
Epoch 2 [89/172] - loss: 0.2079
Epoch 2 [90/172] - loss: 0.4578, acc: 0.8125
Epoch 2 [91/172] - loss: 0.1769
Epoch 2 [92/172] - loss: 0.2987
Epoch 2 [93/172] - loss: 0.2449
Epoch 2 [94/172] - loss: 0.2418
Epoch 2 [95/172] - loss: 0.5745
Epoch 2 [96/172] - loss: 0.2116
Epoch 2 [97/172] - loss: 0.2984
Epoch 2 [98/172] - loss: 0.1820
Epoch 2 [99/172] - loss: 0.1992
Epoch 2 [100/172] - loss: 0.2693, acc: 0.8750
Epoch 2 [101/172] - loss: 0.2515
Epoch 2 [102/172] - loss: 0.2517
Epoch 2 [103/172] - loss: 0.2844
Epoch 2 [104/172] - loss: 0.2339
Epoch 2 [105/172] - loss: 0.3454
Epoch 2 [106/172] - loss: 0.2286
Epoch 2 [107/172] - loss: 0.2158
Epoch 2 [108/172] - loss: 0.6201
Epoch 2 [109/172] - loss: 0.1996
Epoch 2 [110/172] - loss: 0.2805, acc: 0.8750
Epoch 2 [111/172] - loss: 0.1386
Epoch 2 [112/172] - loss: 0.2461
Epoch 2 [113/172] - loss: 0.1600
Epoch 2 [114/172] - loss: 0.2443
Epoch 2 [115/172] - loss: 0.3106
Epoch 2 [116/172] - loss: 0.5293
Epoch 2 [117/172] - loss: 0.4689
Epoch 2 [118/172] - loss: 0.1854
Epoch 2 [119/172] - loss: 0.2586
Epoch 2 [120/172] - loss: 0.3052, acc: 0.8750
Epoch 2 [121/172] - loss: 0.2236
Epoch 2 [122/172] - loss: 0.5641
Epoch 2 [123/172] - loss: 0.2429
Epoch 2 [124/172] - loss: 0.5168
Epoch 2 [125/172] - loss: 0.1628
Epoch 2 [126/172] - loss: 0.2267
Epoch 2 [127/172] - loss: 0.2426
Epoch 2 [128/172] - loss: 0.1796

=== 第 301 次迭代调试信息 ===
当前类别统计：
positive: count=3372.0, difficulty=0.4612, log_difficulty=0.3793, weight=2.8964
neutral: count=2949.0, difficulty=0.3984, log_difficulty=0.3353, weight=2.6767
negative: count=3294.0, difficulty=0.4746, log_difficulty=0.3884, weight=2.9419

当前batch的pt分布：
positive: min=0.4150, max=0.8726, mean=0.6862
neutral: min=0.5137, max=0.9528, mean=0.7752
negative: min=0.0781, max=0.8740, mean=0.6121

当前batch准确率：
整体准确率: 0.8438
positive 准确率: 0.8000
neutral 准确率: 1.0000
negative 准确率: 0.7273

损失分量：
基础交叉熵: 0.4621
焦点损失: 0.1420
边界损失: 0.3447
总损失: 0.3975
Epoch 2 [129/172] - loss: 0.3975
Epoch 2 [130/172] - loss: 0.2614, acc: 0.8750
Epoch 2 [131/172] - loss: 0.3208
Epoch 2 [132/172] - loss: 0.2766
Epoch 2 [133/172] - loss: 0.2514
Epoch 2 [134/172] - loss: 0.3292
Epoch 2 [135/172] - loss: 0.2975
Epoch 2 [136/172] - loss: 0.2942
Epoch 2 [137/172] - loss: 0.1614
Epoch 2 [138/172] - loss: 0.2463
Epoch 2 [139/172] - loss: 0.4288
Epoch 2 [140/172] - loss: 0.3195, acc: 0.8750
Epoch 2 [141/172] - loss: 0.1918
Epoch 2 [142/172] - loss: 0.2302
Epoch 2 [143/172] - loss: 0.2850
Epoch 2 [144/172] - loss: 0.2871
Epoch 2 [145/172] - loss: 0.7531
Epoch 2 [146/172] - loss: 0.2024
Epoch 2 [147/172] - loss: 0.2614
Epoch 2 [148/172] - loss: 0.1791
Epoch 2 [149/172] - loss: 0.2899
Epoch 2 [150/172] - loss: 0.1849, acc: 0.9375
Epoch 2 [151/172] - loss: 0.1856
Epoch 2 [152/172] - loss: 0.2884
Epoch 2 [153/172] - loss: 0.2806
Epoch 2 [154/172] - loss: 0.1572
Epoch 2 [155/172] - loss: 0.2011
Epoch 2 [156/172] - loss: 0.1745
Epoch 2 [157/172] - loss: 0.1356
Epoch 2 [158/172] - loss: 0.1977
Epoch 2 [159/172] - loss: 0.3127
Epoch 2 [160/172] - loss: 0.1235, acc: 1.0000
Epoch 2 [161/172] - loss: 0.1712
Epoch 2 [162/172] - loss: 0.1563
Epoch 2 [163/172] - loss: 0.3113
Epoch 2 [164/172] - loss: 0.3111
Epoch 2 [165/172] - loss: 0.2167
Epoch 2 [166/172] - loss: 0.4154
Epoch 2 [167/172] - loss: 0.2036
Epoch 2 [168/172] - loss: 0.1516
Epoch 2 [169/172] - loss: 0.1376
Epoch 2 [170/172] - loss: 0.1767, acc: 0.9062
Epoch 2 [171/172] - loss: 0.4199
Epoch 2 [172/172] - loss: 0.8228

类别准确率:
positive: 0.8587 (401/467)
neutral: 0.3253 (27/83)
negative: 0.5600 (140/250)

Epoch 2/10
Train Loss: 0.2665, Train Acc: 0.8970
Val Loss: 0.7506, Val Acc: 0.7100
Epoch 3 [1/172] - loss: 0.1382, acc: 0.9688
Epoch 3 [2/172] - loss: 0.1976
Epoch 3 [3/172] - loss: 0.0926
Epoch 3 [4/172] - loss: 0.1646
Epoch 3 [5/172] - loss: 0.1355
Epoch 3 [6/172] - loss: 0.1658
Epoch 3 [7/172] - loss: 0.1432
Epoch 3 [8/172] - loss: 0.1068
Epoch 3 [9/172] - loss: 0.1002
Epoch 3 [10/172] - loss: 0.1056, acc: 0.9688
Epoch 3 [11/172] - loss: 0.2081
Epoch 3 [12/172] - loss: 0.0956
Epoch 3 [13/172] - loss: 0.0816
Epoch 3 [14/172] - loss: 0.0952
Epoch 3 [15/172] - loss: 0.1313
Epoch 3 [16/172] - loss: 0.3458
Epoch 3 [17/172] - loss: 0.2170
Epoch 3 [18/172] - loss: 0.2034
Epoch 3 [19/172] - loss: 0.0948
Epoch 3 [20/172] - loss: 0.1065, acc: 0.9688
Epoch 3 [21/172] - loss: 0.1128
Epoch 3 [22/172] - loss: 0.1291
Epoch 3 [23/172] - loss: 0.2281
Epoch 3 [24/172] - loss: 0.2645
Epoch 3 [25/172] - loss: 0.1169
Epoch 3 [26/172] - loss: 0.1341
Epoch 3 [27/172] - loss: 0.1014
Epoch 3 [28/172] - loss: 0.0764
Epoch 3 [29/172] - loss: 0.2795
Epoch 3 [30/172] - loss: 0.1490, acc: 0.9375
Epoch 3 [31/172] - loss: 0.0783
Epoch 3 [32/172] - loss: 0.0930
Epoch 3 [33/172] - loss: 0.1117
Epoch 3 [34/172] - loss: 0.1658
Epoch 3 [35/172] - loss: 0.2130
Epoch 3 [36/172] - loss: 0.1479
Epoch 3 [37/172] - loss: 0.2241
Epoch 3 [38/172] - loss: 0.1308
Epoch 3 [39/172] - loss: 0.0973
Epoch 3 [40/172] - loss: 0.1638, acc: 0.9375
Epoch 3 [41/172] - loss: 0.1961
Epoch 3 [42/172] - loss: 0.0946
Epoch 3 [43/172] - loss: 0.0972
Epoch 3 [44/172] - loss: 0.1074
Epoch 3 [45/172] - loss: 0.1539
Epoch 3 [46/172] - loss: 0.1152
Epoch 3 [47/172] - loss: 0.0917
Epoch 3 [48/172] - loss: 0.1120
Epoch 3 [49/172] - loss: 0.1199
Epoch 3 [50/172] - loss: 0.0824, acc: 1.0000
Epoch 3 [51/172] - loss: 0.1358
Epoch 3 [52/172] - loss: 0.2047
Epoch 3 [53/172] - loss: 0.1550
Epoch 3 [54/172] - loss: 0.1421
Epoch 3 [55/172] - loss: 0.1303
Epoch 3 [56/172] - loss: 0.1146

=== 第 401 次迭代调试信息 ===
当前类别统计：
positive: count=4493.0, difficulty=0.4124, log_difficulty=0.3453, weight=2.7266
neutral: count=3923.0, difficulty=0.3427, log_difficulty=0.2947, weight=2.4735
negative: count=4382.0, difficulty=0.4209, log_difficulty=0.3513, weight=2.7565

当前batch的pt分布：
positive: min=0.3289, max=0.9859, mean=0.7656
neutral: min=0.0614, max=0.9636, mean=0.6869
negative: min=0.8131, max=0.9651, mean=0.9149

当前batch准确率：
整体准确率: 0.8438
positive 准确率: 0.8182
neutral 准确率: 0.8125
negative 准确率: 1.0000

损失分量：
基础交叉熵: 0.4297
焦点损失: 0.2002
边界损失: 0.2536
总损失: 0.4387
Epoch 3 [57/172] - loss: 0.4387
Epoch 3 [58/172] - loss: 0.0756
Epoch 3 [59/172] - loss: 0.1305
Epoch 3 [60/172] - loss: 0.1031, acc: 0.9688
Epoch 3 [61/172] - loss: 0.1721
Epoch 3 [62/172] - loss: 0.1442
Epoch 3 [63/172] - loss: 0.1010
Epoch 3 [64/172] - loss: 0.1313
Epoch 3 [65/172] - loss: 0.1286
Epoch 3 [66/172] - loss: 0.1347
Epoch 3 [67/172] - loss: 0.1379
Epoch 3 [68/172] - loss: 0.1215
Epoch 3 [69/172] - loss: 0.1508
Epoch 3 [70/172] - loss: 0.0640, acc: 1.0000
Epoch 3 [71/172] - loss: 0.1887
Epoch 3 [72/172] - loss: 0.2106
Epoch 3 [73/172] - loss: 0.1155
Epoch 3 [74/172] - loss: 0.2975
Epoch 3 [75/172] - loss: 0.0769
Epoch 3 [76/172] - loss: 0.2185
Epoch 3 [77/172] - loss: 0.0951
Epoch 3 [78/172] - loss: 0.1916
Epoch 3 [79/172] - loss: 0.0984
Epoch 3 [80/172] - loss: 0.2248, acc: 0.8750
Epoch 3 [81/172] - loss: 0.0827
Epoch 3 [82/172] - loss: 0.0994
Epoch 3 [83/172] - loss: 0.0874
Epoch 3 [84/172] - loss: 0.0668
Epoch 3 [85/172] - loss: 0.1206
Epoch 3 [86/172] - loss: 0.0844
Epoch 3 [87/172] - loss: 0.1723
Epoch 3 [88/172] - loss: 0.0949
Epoch 3 [89/172] - loss: 0.0596
Epoch 3 [90/172] - loss: 0.0980, acc: 0.9688
Epoch 3 [91/172] - loss: 0.1207
Epoch 3 [92/172] - loss: 0.1347
Epoch 3 [93/172] - loss: 0.2593
Epoch 3 [94/172] - loss: 0.1143
Epoch 3 [95/172] - loss: 0.0692
Epoch 3 [96/172] - loss: 0.1170
Epoch 3 [97/172] - loss: 0.0923
Epoch 3 [98/172] - loss: 0.0773
Epoch 3 [99/172] - loss: 0.1039
Epoch 3 [100/172] - loss: 0.1460, acc: 0.9375
Epoch 3 [101/172] - loss: 0.2151
Epoch 3 [102/172] - loss: 0.0534
Epoch 3 [103/172] - loss: 0.1984
Epoch 3 [104/172] - loss: 0.1179
Epoch 3 [105/172] - loss: 0.0578
Epoch 3 [106/172] - loss: 0.1778
Epoch 3 [107/172] - loss: 0.0870
Epoch 3 [108/172] - loss: 0.0763
Epoch 3 [109/172] - loss: 0.0525
Epoch 3 [110/172] - loss: 0.1661, acc: 0.9062
Epoch 3 [111/172] - loss: 0.1221
Epoch 3 [112/172] - loss: 0.1299
Epoch 3 [113/172] - loss: 0.1563
Epoch 3 [114/172] - loss: 0.1145
Epoch 3 [115/172] - loss: 0.1369
Epoch 3 [116/172] - loss: 0.0820
Epoch 3 [117/172] - loss: 0.1987
Epoch 3 [118/172] - loss: 0.2011
Epoch 3 [119/172] - loss: 0.1125
Epoch 3 [120/172] - loss: 0.2370, acc: 0.9062
Epoch 3 [121/172] - loss: 0.1581
Epoch 3 [122/172] - loss: 0.2025
Epoch 3 [123/172] - loss: 0.1002
Epoch 3 [124/172] - loss: 0.1207
Epoch 3 [125/172] - loss: 0.1001
Epoch 3 [126/172] - loss: 0.3049
Epoch 3 [127/172] - loss: 0.1237
Epoch 3 [128/172] - loss: 0.1075
Epoch 3 [129/172] - loss: 0.0664
Epoch 3 [130/172] - loss: 0.0885, acc: 1.0000
Epoch 3 [131/172] - loss: 0.1415
Epoch 3 [132/172] - loss: 0.0566
Epoch 3 [133/172] - loss: 0.0864
Epoch 3 [134/172] - loss: 0.0652
Epoch 3 [135/172] - loss: 0.0866
Epoch 3 [136/172] - loss: 0.1175
Epoch 3 [137/172] - loss: 0.0809
Epoch 3 [138/172] - loss: 0.2001
Epoch 3 [139/172] - loss: 0.0809
Epoch 3 [140/172] - loss: 0.1132, acc: 0.9688
Epoch 3 [141/172] - loss: 0.2789
Epoch 3 [142/172] - loss: 0.2082
Epoch 3 [143/172] - loss: 0.0993
Epoch 3 [144/172] - loss: 0.0963
Epoch 3 [145/172] - loss: 0.0995
Epoch 3 [146/172] - loss: 0.1764
Epoch 3 [147/172] - loss: 0.1031
Epoch 3 [148/172] - loss: 0.1030
Epoch 3 [149/172] - loss: 0.1681
Epoch 3 [150/172] - loss: 0.1451, acc: 0.9688
Epoch 3 [151/172] - loss: 0.2235
Epoch 3 [152/172] - loss: 0.1568
Epoch 3 [153/172] - loss: 0.1212
Epoch 3 [154/172] - loss: 0.1998
Epoch 3 [155/172] - loss: 0.0680
Epoch 3 [156/172] - loss: 0.0985

=== 第 501 次迭代调试信息 ===
当前类别统计：
positive: count=5595.0, difficulty=0.3670, log_difficulty=0.3126, weight=2.5632
neutral: count=4903.0, difficulty=0.2995, log_difficulty=0.2619, weight=2.3097
negative: count=5500.0, difficulty=0.3779, log_difficulty=0.3205, weight=2.6027

当前batch的pt分布：
positive: min=0.5215, max=0.9904, mean=0.8783
neutral: min=0.8423, max=0.9887, mean=0.9418
negative: min=0.6256, max=0.9450, mean=0.8308

当前batch准确率：
整体准确率: 1.0000
positive 准确率: 1.0000
neutral 准确率: 1.0000
negative 准确率: 1.0000

损失分量：
基础交叉熵: 0.1313
焦点损失: 0.0066
边界损失: 0.2063
总损失: 0.0643
Epoch 3 [157/172] - loss: 0.0643
Epoch 3 [158/172] - loss: 0.2242
Epoch 3 [159/172] - loss: 0.1813
Epoch 3 [160/172] - loss: 0.2550, acc: 0.8750
Epoch 3 [161/172] - loss: 0.1021
Epoch 3 [162/172] - loss: 0.1367
Epoch 3 [163/172] - loss: 0.0941
Epoch 3 [164/172] - loss: 0.0763
Epoch 3 [165/172] - loss: 0.1248
Epoch 3 [166/172] - loss: 0.0685
Epoch 3 [167/172] - loss: 0.0887
Epoch 3 [168/172] - loss: 0.0777
Epoch 3 [169/172] - loss: 0.1019
Epoch 3 [170/172] - loss: 0.1621, acc: 0.9062
Epoch 3 [171/172] - loss: 0.0973
Epoch 3 [172/172] - loss: 0.2350

类别准确率:
positive: 0.8608 (402/467)
neutral: 0.2771 (23/83)
negative: 0.5800 (145/250)

Epoch 3/10
Train Loss: 0.1306, Train Acc: 0.9414
Val Loss: 0.7378, Val Acc: 0.7125
Epoch 4 [1/172] - loss: 0.0731, acc: 0.9688
Epoch 4 [2/172] - loss: 0.0659
Epoch 4 [3/172] - loss: 0.0693
Epoch 4 [4/172] - loss: 0.0840
Epoch 4 [5/172] - loss: 0.0852
Epoch 4 [6/172] - loss: 0.0711
Epoch 4 [7/172] - loss: 0.1041
Epoch 4 [8/172] - loss: 0.0967
Epoch 4 [9/172] - loss: 0.2219
Epoch 4 [10/172] - loss: 0.0836, acc: 0.9688
Epoch 4 [11/172] - loss: 0.0628
Epoch 4 [12/172] - loss: 0.0587
Epoch 4 [13/172] - loss: 0.0915
Epoch 4 [14/172] - loss: 0.0694
Epoch 4 [15/172] - loss: 0.0995
Epoch 4 [16/172] - loss: 0.0534
Epoch 4 [17/172] - loss: 0.0665
Epoch 4 [18/172] - loss: 0.0764
Epoch 4 [19/172] - loss: 0.0857
Epoch 4 [20/172] - loss: 0.0769, acc: 0.9688
Epoch 4 [21/172] - loss: 0.1381
Epoch 4 [22/172] - loss: 0.0647
Epoch 4 [23/172] - loss: 0.2787
Epoch 4 [24/172] - loss: 0.0599
Epoch 4 [25/172] - loss: 0.0696
Epoch 4 [26/172] - loss: 0.1367
Epoch 4 [27/172] - loss: 0.0544
Epoch 4 [28/172] - loss: 0.1478
Epoch 4 [29/172] - loss: 0.0665
Epoch 4 [30/172] - loss: 0.1143, acc: 0.9375
Epoch 4 [31/172] - loss: 0.0680
Epoch 4 [32/172] - loss: 0.0995
Epoch 4 [33/172] - loss: 0.1622
Epoch 4 [34/172] - loss: 0.0624
Epoch 4 [35/172] - loss: 0.1049
Epoch 4 [36/172] - loss: 0.0976
Epoch 4 [37/172] - loss: 0.0549
Epoch 4 [38/172] - loss: 0.0549
Epoch 4 [39/172] - loss: 0.1165
Epoch 4 [40/172] - loss: 0.1697, acc: 0.9375
Epoch 4 [41/172] - loss: 0.1057
Epoch 4 [42/172] - loss: 0.2968
Epoch 4 [43/172] - loss: 0.1301
Epoch 4 [44/172] - loss: 0.1550
Epoch 4 [45/172] - loss: 0.0572
Epoch 4 [46/172] - loss: 0.0522
Epoch 4 [47/172] - loss: 0.0745
Epoch 4 [48/172] - loss: 0.0973
Epoch 4 [49/172] - loss: 0.1138
Epoch 4 [50/172] - loss: 0.2450, acc: 0.9688
Epoch 4 [51/172] - loss: 0.0495
Epoch 4 [52/172] - loss: 0.1043
Epoch 4 [53/172] - loss: 0.0595
Epoch 4 [54/172] - loss: 0.0835
Epoch 4 [55/172] - loss: 0.1582
Epoch 4 [56/172] - loss: 0.0900
Epoch 4 [57/172] - loss: 0.0584
Epoch 4 [58/172] - loss: 0.0828
Epoch 4 [59/172] - loss: 0.0677
Epoch 4 [60/172] - loss: 0.0630, acc: 1.0000
Epoch 4 [61/172] - loss: 0.1207
Epoch 4 [62/172] - loss: 0.0924
Epoch 4 [63/172] - loss: 0.0783
Epoch 4 [64/172] - loss: 0.0633
Epoch 4 [65/172] - loss: 0.0909
Epoch 4 [66/172] - loss: 0.0868
Epoch 4 [67/172] - loss: 0.0643
Epoch 4 [68/172] - loss: 0.0594
Epoch 4 [69/172] - loss: 0.0927
Epoch 4 [70/172] - loss: 0.1545, acc: 0.9375
Epoch 4 [71/172] - loss: 0.0714
Epoch 4 [72/172] - loss: 0.0727
Epoch 4 [73/172] - loss: 0.0835
Epoch 4 [74/172] - loss: 0.2855
Epoch 4 [75/172] - loss: 0.0919
Epoch 4 [76/172] - loss: 0.0552
Epoch 4 [77/172] - loss: 0.1686
Epoch 4 [78/172] - loss: 0.0955
Epoch 4 [79/172] - loss: 0.0477
Epoch 4 [80/172] - loss: 0.1624, acc: 0.9688
Epoch 4 [81/172] - loss: 0.2059
Epoch 4 [82/172] - loss: 0.0545
Epoch 4 [83/172] - loss: 0.0554
Epoch 4 [84/172] - loss: 0.0514

=== 第 601 次迭代调试信息 ===
当前类别统计：
positive: count=6687.0, difficulty=0.3301, log_difficulty=0.2853, weight=2.4263
neutral: count=5865.0, difficulty=0.2683, log_difficulty=0.2377, weight=2.1884
negative: count=6629.0, difficulty=0.3404, log_difficulty=0.2930, weight=2.4650

当前batch的pt分布：
positive: min=0.3183, max=0.9880, mean=0.7451
neutral: min=0.8158, max=0.9941, mean=0.9538
negative: min=0.6225, max=0.9809, mean=0.8998

当前batch准确率：
整体准确率: 0.9375
positive 准确率: 0.8750
neutral 准确率: 1.0000
negative 准确率: 1.0000

损失分量：
基础交叉熵: 0.2139
焦点损失: 0.0350
边界损失: 0.2379
总损失: 0.1232
Epoch 4 [85/172] - loss: 0.1232
Epoch 4 [86/172] - loss: 0.1131
Epoch 4 [87/172] - loss: 0.0713
Epoch 4 [88/172] - loss: 0.0572
Epoch 4 [89/172] - loss: 0.0635
Epoch 4 [90/172] - loss: 0.0501, acc: 1.0000
Epoch 4 [91/172] - loss: 0.1957
Epoch 4 [92/172] - loss: 0.2538
Epoch 4 [93/172] - loss: 0.0489
Epoch 4 [94/172] - loss: 0.0568
Epoch 4 [95/172] - loss: 0.0688
Epoch 4 [96/172] - loss: 0.1608
Epoch 4 [97/172] - loss: 0.1829
Epoch 4 [98/172] - loss: 0.0537
Epoch 4 [99/172] - loss: 0.0681
Epoch 4 [100/172] - loss: 0.0648, acc: 1.0000
Epoch 4 [101/172] - loss: 0.1161
Epoch 4 [102/172] - loss: 0.2436
Epoch 4 [103/172] - loss: 0.0879
Epoch 4 [104/172] - loss: 0.1030
Epoch 4 [105/172] - loss: 0.1721
Epoch 4 [106/172] - loss: 0.0681
Epoch 4 [107/172] - loss: 0.0488
Epoch 4 [108/172] - loss: 0.0882
Epoch 4 [109/172] - loss: 0.0514
Epoch 4 [110/172] - loss: 0.3189, acc: 0.8750
Epoch 4 [111/172] - loss: 0.0729
Epoch 4 [112/172] - loss: 0.0606
Epoch 4 [113/172] - loss: 0.0646
Epoch 4 [114/172] - loss: 0.0781
Epoch 4 [115/172] - loss: 0.1466
Epoch 4 [116/172] - loss: 0.1762
Epoch 4 [117/172] - loss: 0.0490
Epoch 4 [118/172] - loss: 0.1671
Epoch 4 [119/172] - loss: 0.0807
Epoch 4 [120/172] - loss: 0.0514, acc: 1.0000
Epoch 4 [121/172] - loss: 0.1748
Epoch 4 [122/172] - loss: 0.2086
Epoch 4 [123/172] - loss: 0.0632
Epoch 4 [124/172] - loss: 0.0598
Epoch 4 [125/172] - loss: 0.0644
Epoch 4 [126/172] - loss: 0.3668
Epoch 4 [127/172] - loss: 0.0793
Epoch 4 [128/172] - loss: 0.0639
Epoch 4 [129/172] - loss: 0.0737
Epoch 4 [130/172] - loss: 0.0498, acc: 1.0000
Epoch 4 [131/172] - loss: 0.0537
Epoch 4 [132/172] - loss: 0.0564
Epoch 4 [133/172] - loss: 0.0625
Epoch 4 [134/172] - loss: 0.0923
Epoch 4 [135/172] - loss: 0.0908
Epoch 4 [136/172] - loss: 0.0675
Epoch 4 [137/172] - loss: 0.0478
Epoch 4 [138/172] - loss: 0.1574
Epoch 4 [139/172] - loss: 0.0696
Epoch 4 [140/172] - loss: 0.0598, acc: 1.0000
Epoch 4 [141/172] - loss: 0.0849
Epoch 4 [142/172] - loss: 0.0807
Epoch 4 [143/172] - loss: 0.0591
Epoch 4 [144/172] - loss: 0.0720
Epoch 4 [145/172] - loss: 0.1206
Epoch 4 [146/172] - loss: 0.0551
Epoch 4 [147/172] - loss: 0.1416
Epoch 4 [148/172] - loss: 0.0679
Epoch 4 [149/172] - loss: 0.0517
Epoch 4 [150/172] - loss: 0.2106, acc: 0.9375
Epoch 4 [151/172] - loss: 0.2066
Epoch 4 [152/172] - loss: 0.0492
Epoch 4 [153/172] - loss: 0.0817
Epoch 4 [154/172] - loss: 0.1942
Epoch 4 [155/172] - loss: 0.1091
Epoch 4 [156/172] - loss: 0.0961
Epoch 4 [157/172] - loss: 0.2481
Epoch 4 [158/172] - loss: 0.0521
Epoch 4 [159/172] - loss: 0.0599
Epoch 4 [160/172] - loss: 0.1055, acc: 0.9688
Epoch 4 [161/172] - loss: 0.1130
Epoch 4 [162/172] - loss: 0.0936
Epoch 4 [163/172] - loss: 0.0768
Epoch 4 [164/172] - loss: 0.0488
Epoch 4 [165/172] - loss: 0.0828
Epoch 4 [166/172] - loss: 0.0577
Epoch 4 [167/172] - loss: 0.1062
Epoch 4 [168/172] - loss: 0.0565
Epoch 4 [169/172] - loss: 0.1623
Epoch 4 [170/172] - loss: 0.1800, acc: 0.9375
Epoch 4 [171/172] - loss: 0.0640
Epoch 4 [172/172] - loss: 0.0699

类别准确率:
positive: 0.9079 (424/467)
neutral: 0.2651 (22/83)
negative: 0.3960 (99/250)

Epoch 4/10
Train Loss: 0.0986, Train Acc: 0.9697
Val Loss: 0.8257, Val Acc: 0.6813
Epoch 5 [1/172] - loss: 0.0583, acc: 1.0000
Epoch 5 [2/172] - loss: 0.1892
Epoch 5 [3/172] - loss: 0.0526
Epoch 5 [4/172] - loss: 0.0688
Epoch 5 [5/172] - loss: 0.0478
Epoch 5 [6/172] - loss: 0.0659
Epoch 5 [7/172] - loss: 0.0561
Epoch 5 [8/172] - loss: 0.1107
Epoch 5 [9/172] - loss: 0.0866
Epoch 5 [10/172] - loss: 0.0722, acc: 0.9688
Epoch 5 [11/172] - loss: 0.0703
Epoch 5 [12/172] - loss: 0.0614

=== 第 701 次迭代调试信息 ===
当前类别统计：
positive: count=7825.0, difficulty=0.3026, log_difficulty=0.2644, weight=2.3218
neutral: count=6845.0, difficulty=0.2427, log_difficulty=0.2173, weight=2.0864
negative: count=7694.0, difficulty=0.3125, log_difficulty=0.2719, weight=2.3595

当前batch的pt分布：
positive: min=0.5316, max=0.9747, mean=0.8443
neutral: min=0.9148, max=0.9970, mean=0.9719
negative: min=0.7839, max=0.9669, mean=0.9126

当前batch准确率：
整体准确率: 1.0000
positive 准确率: 1.0000
neutral 准确率: 1.0000
negative 准确率: 1.0000

损失分量：
基础交叉熵: 0.1192
焦点损失: 0.0069
边界损失: 0.1962
总损失: 0.0611
Epoch 5 [13/172] - loss: 0.0611
Epoch 5 [14/172] - loss: 0.1546
Epoch 5 [15/172] - loss: 0.0671
Epoch 5 [16/172] - loss: 0.0519
Epoch 5 [17/172] - loss: 0.0892
Epoch 5 [18/172] - loss: 0.0559
Epoch 5 [19/172] - loss: 0.0881
Epoch 5 [20/172] - loss: 0.0903, acc: 0.9375
Epoch 5 [21/172] - loss: 0.0637
Epoch 5 [22/172] - loss: 0.2208
Epoch 5 [23/172] - loss: 0.0639
Epoch 5 [24/172] - loss: 0.0479
Epoch 5 [25/172] - loss: 0.0467
Epoch 5 [26/172] - loss: 0.0541
Epoch 5 [27/172] - loss: 0.0510
Epoch 5 [28/172] - loss: 0.0599
Epoch 5 [29/172] - loss: 0.0523
Epoch 5 [30/172] - loss: 0.0812, acc: 0.9688
Epoch 5 [31/172] - loss: 0.0601
Epoch 5 [32/172] - loss: 0.0471
Epoch 5 [33/172] - loss: 0.0596
Epoch 5 [34/172] - loss: 0.0460
Epoch 5 [35/172] - loss: 0.0499
Epoch 5 [36/172] - loss: 0.0465
Epoch 5 [37/172] - loss: 0.0858
Epoch 5 [38/172] - loss: 0.0458
Epoch 5 [39/172] - loss: 0.1624
Epoch 5 [40/172] - loss: 0.0811, acc: 0.9688
Epoch 5 [41/172] - loss: 0.0579
Epoch 5 [42/172] - loss: 0.0574
Epoch 5 [43/172] - loss: 0.2578
Epoch 5 [44/172] - loss: 0.0813
Epoch 5 [45/172] - loss: 0.0434
Epoch 5 [46/172] - loss: 0.0671
Epoch 5 [47/172] - loss: 0.0606
Epoch 5 [48/172] - loss: 0.0508
Epoch 5 [49/172] - loss: 0.1608
Epoch 5 [50/172] - loss: 0.1024, acc: 0.9688
Epoch 5 [51/172] - loss: 0.0903
Epoch 5 [52/172] - loss: 0.0474
Epoch 5 [53/172] - loss: 0.0784
Epoch 5 [54/172] - loss: 0.0796
Epoch 5 [55/172] - loss: 0.0865
Epoch 5 [56/172] - loss: 0.0659
Epoch 5 [57/172] - loss: 0.0697
Epoch 5 [58/172] - loss: 0.0459
Epoch 5 [59/172] - loss: 0.0704
Epoch 5 [60/172] - loss: 0.0564, acc: 1.0000
Epoch 5 [61/172] - loss: 0.0573
Epoch 5 [62/172] - loss: 0.0611
Epoch 5 [63/172] - loss: 0.1149
Epoch 5 [64/172] - loss: 0.0529
Epoch 5 [65/172] - loss: 0.0515
Epoch 5 [66/172] - loss: 0.0589
Epoch 5 [67/172] - loss: 0.0466
Epoch 5 [68/172] - loss: 0.0758
Epoch 5 [69/172] - loss: 0.0510
Epoch 5 [70/172] - loss: 0.0562, acc: 1.0000
Epoch 5 [71/172] - loss: 0.0500
Epoch 5 [72/172] - loss: 0.1533
Epoch 5 [73/172] - loss: 0.0819
Epoch 5 [74/172] - loss: 0.2187
Epoch 5 [75/172] - loss: 0.0459
Epoch 5 [76/172] - loss: 0.0573
Epoch 5 [77/172] - loss: 0.0411
Epoch 5 [78/172] - loss: 0.0576
Epoch 5 [79/172] - loss: 0.0842
Epoch 5 [80/172] - loss: 0.0464, acc: 1.0000
Epoch 5 [81/172] - loss: 0.0829
Epoch 5 [82/172] - loss: 0.0638
Epoch 5 [83/172] - loss: 0.0472
Epoch 5 [84/172] - loss: 0.0484
Epoch 5 [85/172] - loss: 0.0775
Epoch 5 [86/172] - loss: 0.0593
Epoch 5 [87/172] - loss: 0.0835
Epoch 5 [88/172] - loss: 0.1646
Epoch 5 [89/172] - loss: 0.0565
Epoch 5 [90/172] - loss: 0.0925, acc: 0.9688
Epoch 5 [91/172] - loss: 0.0608
Epoch 5 [92/172] - loss: 0.0488
Epoch 5 [93/172] - loss: 0.0481
Epoch 5 [94/172] - loss: 0.0507
Epoch 5 [95/172] - loss: 0.0524
Epoch 5 [96/172] - loss: 0.0544
Epoch 5 [97/172] - loss: 0.0845
Epoch 5 [98/172] - loss: 0.0437
Epoch 5 [99/172] - loss: 0.1266
Epoch 5 [100/172] - loss: 0.0471, acc: 1.0000
Epoch 5 [101/172] - loss: 0.0508
Epoch 5 [102/172] - loss: 0.0757
Epoch 5 [103/172] - loss: 0.0633
Epoch 5 [104/172] - loss: 0.0962
Epoch 5 [105/172] - loss: 0.2851
Epoch 5 [106/172] - loss: 0.0480
Epoch 5 [107/172] - loss: 0.0613
Epoch 5 [108/172] - loss: 0.0760
Epoch 5 [109/172] - loss: 0.0436
Epoch 5 [110/172] - loss: 0.0434, acc: 1.0000
Epoch 5 [111/172] - loss: 0.0498
Epoch 5 [112/172] - loss: 0.0579

=== 第 801 次迭代调试信息 ===
当前类别统计：
positive: count=8959.0, difficulty=0.2781, log_difficulty=0.2454, weight=2.2269
neutral: count=7825.0, difficulty=0.2211, log_difficulty=0.1998, weight=1.9990
negative: count=8780.0, difficulty=0.2878, log_difficulty=0.2529, weight=2.2647

当前batch的pt分布：
positive: min=0.1364, max=0.9856, mean=0.8159
neutral: min=0.8417, max=0.9806, mean=0.9412
negative: min=0.9827, max=0.9976, mean=0.9930

当前batch准确率：
整体准确率: 0.9688
positive 准确率: 0.9375
neutral 准确率: 1.0000
negative 准确率: 1.0000

损失分量：
基础交叉熵: 0.1611
焦点损失: 0.0516
边界损失: 0.1871
总损失: 0.1330
Epoch 5 [113/172] - loss: 0.1330
Epoch 5 [114/172] - loss: 0.0925
Epoch 5 [115/172] - loss: 0.0440
Epoch 5 [116/172] - loss: 0.0680
Epoch 5 [117/172] - loss: 0.0525
Epoch 5 [118/172] - loss: 0.0571
Epoch 5 [119/172] - loss: 0.1132
Epoch 5 [120/172] - loss: 0.0634, acc: 0.9688
Epoch 5 [121/172] - loss: 0.0629
Epoch 5 [122/172] - loss: 0.1038
Epoch 5 [123/172] - loss: 0.1302
Epoch 5 [124/172] - loss: 0.0488
Epoch 5 [125/172] - loss: 0.0440
Epoch 5 [126/172] - loss: 0.0551
Epoch 5 [127/172] - loss: 0.1042
Epoch 5 [128/172] - loss: 0.0835
Epoch 5 [129/172] - loss: 0.1051
Epoch 5 [130/172] - loss: 0.0442, acc: 1.0000
Epoch 5 [131/172] - loss: 0.0555
Epoch 5 [132/172] - loss: 0.1228
Epoch 5 [133/172] - loss: 0.0631
Epoch 5 [134/172] - loss: 0.1112
Epoch 5 [135/172] - loss: 0.0450
Epoch 5 [136/172] - loss: 0.0486
Epoch 5 [137/172] - loss: 0.0809
Epoch 5 [138/172] - loss: 0.0713
Epoch 5 [139/172] - loss: 0.2214
Epoch 5 [140/172] - loss: 0.0838, acc: 0.9688
Epoch 5 [141/172] - loss: 0.0670
Epoch 5 [142/172] - loss: 0.0488
Epoch 5 [143/172] - loss: 0.0726
Epoch 5 [144/172] - loss: 0.0490
Epoch 5 [145/172] - loss: 0.0868
Epoch 5 [146/172] - loss: 0.0592
Epoch 5 [147/172] - loss: 0.0751
Epoch 5 [148/172] - loss: 0.0473
Epoch 5 [149/172] - loss: 0.0478
Epoch 5 [150/172] - loss: 0.0915, acc: 0.9375
Epoch 5 [151/172] - loss: 0.0460
Epoch 5 [152/172] - loss: 0.0425
Epoch 5 [153/172] - loss: 0.0454
Epoch 5 [154/172] - loss: 0.0597
Epoch 5 [155/172] - loss: 0.0461
Epoch 5 [156/172] - loss: 0.0593
Epoch 5 [157/172] - loss: 0.0511
Epoch 5 [158/172] - loss: 0.0446
Epoch 5 [159/172] - loss: 0.0480
Epoch 5 [160/172] - loss: 0.0438, acc: 1.0000
Epoch 5 [161/172] - loss: 0.0428
Epoch 5 [162/172] - loss: 0.0552
Epoch 5 [163/172] - loss: 0.0663
Epoch 5 [164/172] - loss: 0.0412
Epoch 5 [165/172] - loss: 0.1302
Epoch 5 [166/172] - loss: 0.0685
Epoch 5 [167/172] - loss: 0.0519
Epoch 5 [168/172] - loss: 0.0504
Epoch 5 [169/172] - loss: 0.0457
Epoch 5 [170/172] - loss: 0.0615, acc: 1.0000
Epoch 5 [171/172] - loss: 0.0494
Epoch 5 [172/172] - loss: 0.0681

类别准确率:
positive: 0.8415 (393/467)
neutral: 0.3012 (25/83)
negative: 0.5640 (141/250)

Epoch 5/10
Train Loss: 0.0574, Train Acc: 0.9939
Val Loss: 0.8193, Val Acc: 0.6987
Epoch 6 [1/172] - loss: 0.0641, acc: 1.0000
Epoch 6 [2/172] - loss: 0.0524
Epoch 6 [3/172] - loss: 0.0409
Epoch 6 [4/172] - loss: 0.0425
Epoch 6 [5/172] - loss: 0.0793
Epoch 6 [6/172] - loss: 0.0419
Epoch 6 [7/172] - loss: 0.0436
Epoch 6 [8/172] - loss: 0.0560
Epoch 6 [9/172] - loss: 0.0424
Epoch 6 [10/172] - loss: 0.0439, acc: 1.0000
Epoch 6 [11/172] - loss: 0.0428
Epoch 6 [12/172] - loss: 0.0420
Epoch 6 [13/172] - loss: 0.0466
Epoch 6 [14/172] - loss: 0.0399
Epoch 6 [15/172] - loss: 0.0423
Epoch 6 [16/172] - loss: 0.0945
Epoch 6 [17/172] - loss: 0.0446
Epoch 6 [18/172] - loss: 0.0446
Epoch 6 [19/172] - loss: 0.0419
Epoch 6 [20/172] - loss: 0.0432, acc: 1.0000
Epoch 6 [21/172] - loss: 0.0602
Epoch 6 [22/172] - loss: 0.0540
Epoch 6 [23/172] - loss: 0.0535
Epoch 6 [24/172] - loss: 0.0447
Epoch 6 [25/172] - loss: 0.0412
Epoch 6 [26/172] - loss: 0.0630
Epoch 6 [27/172] - loss: 0.1609
Epoch 6 [28/172] - loss: 0.0446
Epoch 6 [29/172] - loss: 0.0590
Epoch 6 [30/172] - loss: 0.0424, acc: 1.0000
Epoch 6 [31/172] - loss: 0.0451
Epoch 6 [32/172] - loss: 0.0407
Epoch 6 [33/172] - loss: 0.0397
Epoch 6 [34/172] - loss: 0.0421
Epoch 6 [35/172] - loss: 0.0430
Epoch 6 [36/172] - loss: 0.0507
Epoch 6 [37/172] - loss: 0.0446
Epoch 6 [38/172] - loss: 0.0421
Epoch 6 [39/172] - loss: 0.0464
Epoch 6 [40/172] - loss: 0.0920, acc: 0.9688

=== 第 901 次迭代调试信息 ===
当前类别统计：
positive: count=10062.0, difficulty=0.2569, log_difficulty=0.2286, weight=2.1432
neutral: count=8815.0, difficulty=0.2043, log_difficulty=0.1859, weight=1.9294
negative: count=9870.0, difficulty=0.2657, log_difficulty=0.2356, weight=2.1781

当前batch的pt分布：
positive: min=0.4232, max=0.9946, mean=0.9107
neutral: min=0.8986, max=0.9965, mean=0.9602
negative: min=0.7429, max=0.9891, mean=0.9192

当前batch准确率：
整体准确率: 0.9688
positive 准确率: 0.9091
neutral 准确率: 1.0000
negative 准确率: 1.0000

损失分量：
基础交叉熵: 0.0834
焦点损失: 0.0091
边界损失: 0.1713
总损失: 0.0575
Epoch 6 [41/172] - loss: 0.0575
Epoch 6 [42/172] - loss: 0.0431
Epoch 6 [43/172] - loss: 0.0967
Epoch 6 [44/172] - loss: 0.0423
Epoch 6 [45/172] - loss: 0.1004
Epoch 6 [46/172] - loss: 0.0560
Epoch 6 [47/172] - loss: 0.1045
Epoch 6 [48/172] - loss: 0.0439
Epoch 6 [49/172] - loss: 0.0462
Epoch 6 [50/172] - loss: 0.0613, acc: 1.0000
Epoch 6 [51/172] - loss: 0.0626
Epoch 6 [52/172] - loss: 0.0553
Epoch 6 [53/172] - loss: 0.0417
Epoch 6 [54/172] - loss: 0.0966
Epoch 6 [55/172] - loss: 0.0514
Epoch 6 [56/172] - loss: 0.0591
Epoch 6 [57/172] - loss: 0.0417
Epoch 6 [58/172] - loss: 0.0412
Epoch 6 [59/172] - loss: 0.0498
Epoch 6 [60/172] - loss: 0.0858, acc: 0.9688
Epoch 6 [61/172] - loss: 0.0575
Epoch 6 [62/172] - loss: 0.0909
Epoch 6 [63/172] - loss: 0.0465
Epoch 6 [64/172] - loss: 0.0813
Epoch 6 [65/172] - loss: 0.0666
Epoch 6 [66/172] - loss: 0.0435
Epoch 6 [67/172] - loss: 0.0411
Epoch 6 [68/172] - loss: 0.0548
Epoch 6 [69/172] - loss: 0.0597
Epoch 6 [70/172] - loss: 0.0478, acc: 1.0000
Epoch 6 [71/172] - loss: 0.0562
Epoch 6 [72/172] - loss: 0.0544
Epoch 6 [73/172] - loss: 0.0699
Epoch 6 [74/172] - loss: 0.0407
Epoch 6 [75/172] - loss: 0.0515
Epoch 6 [76/172] - loss: 0.0440
Epoch 6 [77/172] - loss: 0.0721
Epoch 6 [78/172] - loss: 0.0552
Epoch 6 [79/172] - loss: 0.0403
Epoch 6 [80/172] - loss: 0.0543, acc: 0.9688
Epoch 6 [81/172] - loss: 0.0531
Epoch 6 [82/172] - loss: 0.0468
Epoch 6 [83/172] - loss: 0.0418
Epoch 6 [84/172] - loss: 0.0436
Epoch 6 [85/172] - loss: 0.0740
Epoch 6 [86/172] - loss: 0.0501
Epoch 6 [87/172] - loss: 0.0472
Epoch 6 [88/172] - loss: 0.0760
Epoch 6 [89/172] - loss: 0.0834
Epoch 6 [90/172] - loss: 0.0441, acc: 1.0000
Epoch 6 [91/172] - loss: 0.0434
Epoch 6 [92/172] - loss: 0.0443
Epoch 6 [93/172] - loss: 0.0400
Epoch 6 [94/172] - loss: 0.0537
Epoch 6 [95/172] - loss: 0.0612
Epoch 6 [96/172] - loss: 0.0519
Epoch 6 [97/172] - loss: 0.0506
Epoch 6 [98/172] - loss: 0.0422
Epoch 6 [99/172] - loss: 0.0413
Epoch 6 [100/172] - loss: 0.0435, acc: 1.0000
Epoch 6 [101/172] - loss: 0.0682
Epoch 6 [102/172] - loss: 0.0410
Epoch 6 [103/172] - loss: 0.0558
Epoch 6 [104/172] - loss: 0.0567
Epoch 6 [105/172] - loss: 0.0486
Epoch 6 [106/172] - loss: 0.0522
Epoch 6 [107/172] - loss: 0.0430
Epoch 6 [108/172] - loss: 0.0418
Epoch 6 [109/172] - loss: 0.1742
Epoch 6 [110/172] - loss: 0.0798, acc: 0.9688
Epoch 6 [111/172] - loss: 0.0411
Epoch 6 [112/172] - loss: 0.0423
Epoch 6 [113/172] - loss: 0.0650
Epoch 6 [114/172] - loss: 0.0413
Epoch 6 [115/172] - loss: 0.0588
Epoch 6 [116/172] - loss: 0.1552
Epoch 6 [117/172] - loss: 0.0417
Epoch 6 [118/172] - loss: 0.0408
Epoch 6 [119/172] - loss: 0.0660
Epoch 6 [120/172] - loss: 0.0401, acc: 1.0000
Epoch 6 [121/172] - loss: 0.0454
Epoch 6 [122/172] - loss: 0.0464
Epoch 6 [123/172] - loss: 0.0429
Epoch 6 [124/172] - loss: 0.0396
Epoch 6 [125/172] - loss: 0.0440
Epoch 6 [126/172] - loss: 0.0540
Epoch 6 [127/172] - loss: 0.1341
Epoch 6 [128/172] - loss: 0.0461
Epoch 6 [129/172] - loss: 0.0419
Epoch 6 [130/172] - loss: 0.0503, acc: 1.0000
Epoch 6 [131/172] - loss: 0.0581
Epoch 6 [132/172] - loss: 0.0511
Epoch 6 [133/172] - loss: 0.0409
Epoch 6 [134/172] - loss: 0.0482
Epoch 6 [135/172] - loss: 0.0406
Epoch 6 [136/172] - loss: 0.0460
Epoch 6 [137/172] - loss: 0.0437
Epoch 6 [138/172] - loss: 0.0468
Epoch 6 [139/172] - loss: 0.0430
Epoch 6 [140/172] - loss: 0.0460, acc: 1.0000

=== 第 1001 次迭代调试信息 ===
当前类别统计：
positive: count=11179.0, difficulty=0.2386, log_difficulty=0.2140, weight=2.0700
neutral: count=9796.0, difficulty=0.1901, log_difficulty=0.1740, weight=1.8700
negative: count=10972.0, difficulty=0.2470, log_difficulty=0.2208, weight=2.1038

当前batch的pt分布：
positive: min=0.9388, max=0.9973, mean=0.9746
neutral: min=0.9561, max=0.9905, mean=0.9796
negative: min=0.7426, max=0.9927, mean=0.9113

当前batch准确率：
整体准确率: 1.0000
positive 准确率: 1.0000
neutral 准确率: 1.0000
negative 准确率: 1.0000

损失分量：
基础交叉熵: 0.0530
焦点损失: 0.0010
边界损失: 0.1612
总损失: 0.0420
Epoch 6 [141/172] - loss: 0.0420
Epoch 6 [142/172] - loss: 0.0430
Epoch 6 [143/172] - loss: 0.0441
Epoch 6 [144/172] - loss: 0.0435
Epoch 6 [145/172] - loss: 0.0393
Epoch 6 [146/172] - loss: 0.0398
Epoch 6 [147/172] - loss: 0.0432
Epoch 6 [148/172] - loss: 0.0462
Epoch 6 [149/172] - loss: 0.1563
Epoch 6 [150/172] - loss: 0.0861, acc: 0.9688
Epoch 6 [151/172] - loss: 0.0488
Epoch 6 [152/172] - loss: 0.0531
Epoch 6 [153/172] - loss: 0.0409
Epoch 6 [154/172] - loss: 0.0464
Epoch 6 [155/172] - loss: 0.0932
Epoch 6 [156/172] - loss: 0.0886
Epoch 6 [157/172] - loss: 0.0404
Epoch 6 [158/172] - loss: 0.1049
Epoch 6 [159/172] - loss: 0.0444
Epoch 6 [160/172] - loss: 0.0779, acc: 0.9688
Epoch 6 [161/172] - loss: 0.0537
Epoch 6 [162/172] - loss: 0.0490
Epoch 6 [163/172] - loss: 0.0507
Epoch 6 [164/172] - loss: 0.0625
Epoch 6 [165/172] - loss: 0.1990
Epoch 6 [166/172] - loss: 0.0464
Epoch 6 [167/172] - loss: 0.0388
Epoch 6 [168/172] - loss: 0.0455
Epoch 6 [169/172] - loss: 0.0655
Epoch 6 [170/172] - loss: 0.0408, acc: 1.0000
Epoch 6 [171/172] - loss: 0.0425
Epoch 6 [172/172] - loss: 0.0455

类别准确率:
positive: 0.8223 (384/467)
neutral: 0.2530 (21/83)
negative: 0.6280 (157/250)

Epoch 6/10
Train Loss: 0.0630, Train Acc: 0.9919
Val Loss: 0.8047, Val Acc: 0.7025
Early stopping triggered!
Best validation accuracy: 0.7125

=== 标准错误 ===
/root/miniconda3/lib/python3.12/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
/root/miniconda3/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: leofyfan (leofyfan-east-china-normal-university). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /root/project5/wandb/run-20250118_121250-vrrdi7vt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run loss_focal_alpha0.75_beta0.25_weight1.5_dropout0.3_Multimodal_iterations_20250118_121249
wandb: ⭐️ View project at https://wandb.ai/leofyfan-east-china-normal-university/multimodal_sentiment_analysis_loss
wandb: 🚀 View run at https://wandb.ai/leofyfan-east-china-normal-university/multimodal_sentiment_analysis_loss/runs/vrrdi7vt
wandb: uploading wandb-summary.json; uploading config.yaml; uploading output.log
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:  iteration ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇▇███
wandb:  train_acc ▁▂▂▃▅▆▅▆▅▅▆▆▆▆▆█▇█▇▇█████▇█▇████████████
wandb: train_loss █▆▅▆▅▄▄▃▃▃▃▂▂▂▂▂▁▁▂▂▂▂▂▂▂▁▁▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:  iteration 1030
wandb:  train_acc 1
wandb: train_loss 0.04083
wandb: 
wandb: 🚀 View run loss_focal_alpha0.75_beta0.25_weight1.5_dropout0.3_Multimodal_iterations_20250118_121249 at: https://wandb.ai/leofyfan-east-china-normal-university/multimodal_sentiment_analysis_loss/runs/vrrdi7vt
wandb: ⭐️ View project at: https://wandb.ai/leofyfan-east-china-normal-university/multimodal_sentiment_analysis_loss
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250118_121250-vrrdi7vt/logs
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /root/project5/wandb/run-20250118_122200-ha01vm26
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run loss_focal_alpha0.75_beta0.25_weight1.5_dropout0.3_Multimodal_epochs_20250118_122200
wandb: ⭐️ View project at https://wandb.ai/leofyfan-east-china-normal-university/multimodal_sentiment_analysis_loss
wandb: 🚀 View run at https://wandb.ai/leofyfan-east-china-normal-university/multimodal_sentiment_analysis_loss/runs/ha01vm26
wandb: uploading summary; updating run config; uploading wandb-summary.json
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:      epoch ▁▂▄▅▇█
wandb:  train_acc ▁▅▇▇██
wandb: train_loss █▄▂▂▁▁
wandb:    val_acc ▁██▅▇▇
wandb:   val_loss ▅▂▁█▇▆
wandb: 
wandb: Run summary:
wandb:      epoch 6
wandb:  train_acc 0.99192
wandb: train_loss 0.06296
wandb:    val_acc 0.7025
wandb:   val_loss 0.80469
wandb: 
wandb: 🚀 View run loss_focal_alpha0.75_beta0.25_weight1.5_dropout0.3_Multimodal_epochs_20250118_122200 at: https://wandb.ai/leofyfan-east-china-normal-university/multimodal_sentiment_analysis_loss/runs/ha01vm26
wandb: ⭐️ View project at: https://wandb.ai/leofyfan-east-china-normal-university/multimodal_sentiment_analysis_loss
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250118_122200-ha01vm26/logs

